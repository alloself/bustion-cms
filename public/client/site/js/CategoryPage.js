import{l as h}from"./lodash.js";import{s as v}from"./VAvatar.js";import{_ as C}from"./_plugin-vue_export-helper.js";import{o as s,c as p,P as o,x as l,Q as u,ai as n,aj as B,ak as V,r as $,ad as m,ae as _,a4 as g}from"./vuetify.js";import{V as x}from"./VImg.js";import{V as S,a as w,b as y,c as k}from"./VRow.js";const b={props:["item"],data:()=>({}),computed:{previewImage(){var e,r;const t=(r=(e=this.item)==null?void 0:e.images)==null?void 0:r.find(({pivot:i})=>i.key==="preview");return t?t.path:""},isLiquid(){return this.item.attributes.find(({key:t,pivot:e})=>t==="liquid"&&(e==null?void 0:e.value)==="true")}}},I={class:"card--content"};function q(t,e,r,i,P,c){return s(),p(S,B(V(t.$attrs)),{default:o(()=>[l(x,{src:c.previewImage,class:"black--text align-end","min-height":"250px","max-height":"500px",cover:""},{default:o(()=>[u("div",I,[u("div",null,[u("h2",null,n(r.item.price)+" ₽",1),u("span",null,n(r.item.weight)+" "+n(c.isLiquid?"мл.":"г."),1)]),u("h3",null,n(r.item.title),1)])]),_:1},8,["src"])]),_:1},16)}const L=C(b,[["render",q],["__scopeId","data-v-978f2c21"]]),E={components:{ProductCard:L},data:()=>({items:[],products:[],loading:!1}),methods:{sortBy:h.sortBy,async getItems(t){try{this.loading=!0;const{data:e}=await v.get("/category",{params:{slug:t}});console.log(e),this.items=e.flatMap(({children:r,products:i})=>(this.products=h.sortBy(i,"order"),r))}catch(e){console.log(e)}finally{this.loading=!1}},onProductClick(t){this.$router.push({name:"Product",params:{productSlug:t.slug,categorySlug:this.$route.params.categorySlug}})}},computed:{slug(){return this.$route.params.categorySlug}},beforeMount(){this.getItems(this.slug)}},M={class:"mb-6"};function N(t,e,r,i,P,c){const f=$("product-card");return s(),p(w,{fluid:""},{default:o(()=>[l(y,{class:"mb-2"},{default:o(()=>[(s(!0),m(g,null,_(t.products,a=>(s(),p(k,{lg:"4",sm:"6",cols:"6",key:a.id},{default:o(()=>[l(f,{id:a.slug,item:a,to:{name:"Product",params:{productSlug:a.slug,categorySlug:t.$route.params.categorySlug}}},null,8,["id","item","to"])]),_:2},1024))),128))]),_:1}),(s(!0),m(g,null,_(c.sortBy(t.items,"order"),a=>(s(),m(g,{key:a.id},[u("h1",M,n(a.title),1),l(y,null,{default:o(()=>[(s(!0),m(g,null,_(c.sortBy(a.products,"order"),d=>(s(),p(k,{lg:"4",sm:"6",cols:"6",key:d.id},{default:o(()=>[l(f,{id:d.slug,item:d,onClick:R=>c.onProductClick(d)},null,8,["id","item","onClick"])]),_:2},1024))),128))]),_:2},1024)],64))),128))]),_:1})}const G=C(E,[["render",N]]);export{G as default};
