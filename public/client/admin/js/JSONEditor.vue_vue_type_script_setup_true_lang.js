import{l as $}from"./lodash.js";import{Z as J,C as x,U as O,V as v,l as b,E as w,W as R,B as W,X as I,D as T}from"./index.js";import{V as B}from"./VTooltip.js";import{V as A,a as h}from"./VRow.js";import{V as N}from"./VSpacer.js";import{l as F,i as M,r as s,w as X,W as Z,R as q,S as e,a9 as d,$ as k,I as l,u as c,J as S,_ as i}from"./vue-codemirror.js";const z={class:"ml-2"},G=d("div",null,null,-1),H=["onInput"],K=["onInput"],L=d("span",null,"Создать",-1),Q=d("span",null,"Удалить выбранное",-1),ne=F({__name:"JSONEditor",props:{modelValue:{default:()=>({})},title:{default:""},icon:{default:"mdi-code-json"}},emits:["update:model-value"],setup(U,{emit:j}){const p=M("loading",s(!1)),f=U,V=j,_=s([]),n=s({key:"",value:""}),r=s(!1),D=s([{title:"Ключ",key:"key"},{title:"Значение",key:"value"}]),m=s([]),E=()=>{V("update:model-value",{...f.modelValue,[n.value.key]:n.value.value}),r.value=!1},P=()=>{const o=$.differenceBy(m.value,_.value,"key");V("update:model-value",o.reduce((t,a)=>(t[a.key]=a.value,t),{}))},g=(o,t,a)=>{const u=o.target;t[a]=u.outerText,V("update:model-value",m.value.reduce((y,C)=>(y[C.key]=C.value,y),{}))};return X(()=>f.modelValue,o=>{o&&(m.value=Object.keys(o).map(t=>({key:t,value:f.modelValue[t]})))}),(o,t)=>(Z(),q(w,{variant:"tonal",flat:"",loading:c(p),"prepend-icon":o.icon,class:"mb-8"},{title:e(()=>[d("span",z,k(o.title),1)]),default:e(()=>[l(J,{modelValue:_.value,"onUpdate:modelValue":t[0]||(t[0]=a=>_.value=a),"show-select":"","return-object":"",headers:D.value,items:m.value,loading:c(p)},{bottom:e(()=>[G]),"item.key":e(({item:a})=>[d("span",{contenteditable:"true",class:"px-2 py-2",onInput:u=>g(u,a,"key")},k(a.key),41,H)]),"item.value":e(({item:a})=>[d("span",{contenteditable:"true",class:"px-2 py-2",onInput:u=>g(u,a,"value")},k(a.value),41,K)]),_:2},1032,["modelValue","headers","items","loading"]),l(x),l(T,null,{default:e(()=>[l(O,{modelValue:r.value,"onUpdate:modelValue":t[5]||(t[5]=a=>r.value=a),"close-on-content-click":!1,location:"right",offset:"16"},{activator:e(a=>[l(B,{location:"top",text:"Создать",color:"primary"},{activator:e(u=>[l(v,S({icon:"",large:""},{...u.props,...a.props},{loading:c(p),flat:"",onClick:t[1]||(t[1]=y=>r.value=!0)}),{default:e(()=>[l(b,null,{default:e(()=>[i("mdi-plus")]),_:1})]),_:2},1040,["loading"])]),default:e(()=>[L]),_:2},1024)]),default:e(()=>[l(w,{width:"500"},{default:e(()=>[l(R,null,{default:e(()=>[i("Добавить")]),_:1}),l(W,{class:"mt-2"},{default:e(()=>[l(A,null,{default:e(()=>[l(h,{cols:"6"},{default:e(()=>[l(I,{label:"Ключ",modelValue:n.value.key,"onUpdate:modelValue":t[2]||(t[2]=a=>n.value.key=a)},null,8,["modelValue"])]),_:1}),l(h,{cols:"6"},{default:e(()=>[l(I,{label:"Значение",modelValue:n.value.value,"onUpdate:modelValue":t[3]||(t[3]=a=>n.value.value=a)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),l(x),l(T,null,{default:e(()=>[l(N),l(v,{variant:"text",onClick:t[4]||(t[4]=a=>r.value=!1)},{default:e(()=>[i(" Отмена ")]),_:1}),l(v,{color:"primary",variant:"text",onClick:E,disabled:!n.value.key||!n.value.value},{default:e(()=>[i(" Добавить ")]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(B,{location:"top",text:"Удалить выбранное",color:"primary"},{activator:e(({props:a})=>[l(v,S({icon:"",large:"",loading:c(p)},a,{flat:"",onClick:P}),{default:e(()=>[l(b,null,{default:e(()=>[i("mdi-delete")]),_:1})]),_:2},1040,["loading"])]),default:e(()=>[Q]),_:1}),l(N)]),_:1})]),_:1},8,["loading","prepend-icon"]))}});export{ne as _};
