import{l as P}from"./lodash.js";import{$ as F,E as x,X as O,n as v,o as C,G as w,Y as X,D as A,V as T,F as I}from"./index.js";import{V as h}from"./VTooltip.js";import{V as G,a as B}from"./VRow.js";import{V as N}from"./VSpacer.js";import{l as H,i as J,r as s,w as K,W as M,U as R,X as e,ab as d,a0 as k,H as l,u as c,K as U,$ as i}from"./vue-codemirror.js";const W={class:"ml-2"},Y=d("div",null,null,-1),q=["onInput"],z=["onInput"],L=d("span",null,"Создать",-1),Q=d("span",null,"Удалить выбранное",-1),ne=H({__name:"JSONEditor",props:{modelValue:{default:()=>({})},title:{default:""},icon:{default:"mdi-code-json"}},emits:["update:model-value"],setup(j,{emit:D}){const p=J("loading",s(!1)),f=j,V=D,_=s([]),n=s({key:"",value:""}),r=s(!1),S=s([{title:"Ключ",key:"key"},{title:"Значение",key:"value"}]),m=s([]),$=()=>{V("update:model-value",{...f.modelValue,[n.value.key]:n.value.value}),r.value=!1},E=()=>{const o=P.differenceBy(m.value,_.value,"key");V("update:model-value",o.reduce((t,a)=>(t[a.key]=a.value,t),{}))},g=(o,t,a)=>{const u=o.target;t[a]=u.outerText,V("update:model-value",m.value.reduce((y,b)=>(y[b.key]=b.value,y),{}))};return K(()=>f.modelValue,o=>{o&&(m.value=Object.keys(o).map(t=>({key:t,value:f.modelValue[t]})))}),(o,t)=>(M(),R(w,{variant:"tonal",flat:"",loading:c(p),"prepend-icon":o.icon,class:"mb-8"},{title:e(()=>[d("span",W,k(o.title),1)]),default:e(()=>[l(F,{modelValue:_.value,"onUpdate:modelValue":t[0]||(t[0]=a=>_.value=a),"show-select":"","return-object":"",headers:S.value,items:m.value,loading:c(p)},{bottom:e(()=>[Y]),"item.key":e(({item:a})=>[d("span",{contenteditable:"true",class:"px-2 py-2",onInput:u=>g(u,a,"key")},k(a.key),41,q)]),"item.value":e(({item:a})=>[d("span",{contenteditable:"true",class:"px-2 py-2",onInput:u=>g(u,a,"value")},k(a.value),41,z)]),_:2},1032,["modelValue","headers","items","loading"]),l(x),l(I,null,{default:e(()=>[l(O,{modelValue:r.value,"onUpdate:modelValue":t[5]||(t[5]=a=>r.value=a),"close-on-content-click":!1,location:"right",offset:"16"},{activator:e(a=>[l(h,{location:"top",text:"Создать",color:"primary"},{activator:e(u=>[l(v,U({icon:"",large:""},{...u.props,...a.props},{loading:c(p),flat:"",onClick:t[1]||(t[1]=y=>r.value=!0)}),{default:e(()=>[l(C,null,{default:e(()=>[i("mdi-plus")]),_:1})]),_:2},1040,["loading"])]),default:e(()=>[L]),_:2},1024)]),default:e(()=>[l(w,{width:"500"},{default:e(()=>[l(X,null,{default:e(()=>[i("Добавить")]),_:1}),l(A,{class:"mt-2"},{default:e(()=>[l(G,null,{default:e(()=>[l(B,{cols:"6"},{default:e(()=>[l(T,{label:"Ключ",modelValue:n.value.key,"onUpdate:modelValue":t[2]||(t[2]=a=>n.value.key=a)},null,8,["modelValue"])]),_:1}),l(B,{cols:"6"},{default:e(()=>[l(T,{label:"Значение",modelValue:n.value.value,"onUpdate:modelValue":t[3]||(t[3]=a=>n.value.value=a)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),l(x),l(I,null,{default:e(()=>[l(N),l(v,{variant:"text",onClick:t[4]||(t[4]=a=>r.value=!1)},{default:e(()=>[i(" Отмена ")]),_:1}),l(v,{color:"primary",variant:"text",onClick:$,disabled:!n.value.key||!n.value.value},{default:e(()=>[i(" Добавить ")]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(h,{location:"top",text:"Удалить выбранное",color:"primary"},{activator:e(({props:a})=>[l(v,U({icon:"",large:"",loading:c(p)},a,{flat:"",onClick:E}),{default:e(()=>[l(C,null,{default:e(()=>[i("mdi-delete")]),_:1})]),_:2},1040,["loading"])]),default:e(()=>[Q]),_:1}),l(N)]),_:1})]),_:1},8,["loading","prepend-icon"]))}});export{ne as _};
