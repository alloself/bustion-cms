import{r as Y,I as Vn,a as Pe,j,u as F,n as ue,H as _n,b as ke,w as ye,q as Sn,ab as A,D as Kn,x as Gn,s as xn,l as An,d as _e,L as jn,p as Yn,B as Xn,i as En,A as Be,W as He,R as on,S as sn,X as Jn,Y as Qn,F as Zn,a5 as et,J as nt,a7 as tt}from"./vue-codemirror.js";import{c as dn}from"./index.esm.js";import{l as rt}from"./lodash.js";import{p as lt,G as at,H as it,g as ut,I as ot,h as st,y as dt}from"./index.js";const ct=lt({...at(),...it()},"VForm"),ft=ut()({name:"VForm",props:ct(),emits:{"update:modelValue":e=>!0,submit:e=>!0},setup(e,n){let{slots:t,emit:a}=n;const i=ot(e),u=Y();function d(s){s.preventDefault(),i.reset()}function v(s){const c=s,y=i.validate();c.then=y.then.bind(y),c.catch=y.catch.bind(y),c.finally=y.finally.bind(y),a("submit",c),c.defaultPrevented||y.then(p=>{var b;let{valid:V}=p;V&&((b=u.value)==null||b.submit())}),c.preventDefault()}return st(()=>{var s;return Vn("form",{ref:u,class:["v-form",e.class],style:e.style,novalidate:!0,onReset:d,onSubmit:v},[(s=t.default)==null?void 0:s.call(t,i)])}),dt(i,u)}});/**
  * vee-validate v4.12.6
  * (c) 2024 Abdelrahman Awad
  * @license MIT
  */function z(e){return typeof e=="function"}function Cn(e){return e==null}const ge=e=>e!==null&&!!e&&typeof e=="object"&&!Array.isArray(e);function Ze(e){return Number(e)>=0}function vt(e){const n=parseFloat(e);return isNaN(n)?e:n}function ht(e){return typeof e=="object"&&e!==null}function mt(e){return e==null?e===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(e)}function cn(e){if(!ht(e)||mt(e)!=="[object Object]")return!1;if(Object.getPrototypeOf(e)===null)return!0;let n=e;for(;Object.getPrototypeOf(n)!==null;)n=Object.getPrototypeOf(n);return Object.getPrototypeOf(e)===n}function Ae(e,n){return Object.keys(n).forEach(t=>{if(cn(n[t])&&cn(e[t])){e[t]||(e[t]={}),Ae(e[t],n[t]);return}e[t]=n[t]}),e}function Se(e){const n=e.split(".");if(!n.length)return"";let t=String(n[0]);for(let a=1;a<n.length;a++){if(Ze(n[a])){t+=`[${n[a]}]`;continue}t+=`.${n[a]}`}return t}const yt={};function gt(e){return yt[e]}function fn(e,n,t){typeof t.value=="object"&&(t.value=I(t.value)),!t.enumerable||t.get||t.set||!t.configurable||!t.writable||n==="__proto__"?Object.defineProperty(e,n,t):e[n]=t.value}function I(e){if(typeof e!="object")return e;var n=0,t,a,i,u=Object.prototype.toString.call(e);if(u==="[object Object]"?i=Object.create(e.__proto__||null):u==="[object Array]"?i=Array(e.length):u==="[object Set]"?(i=new Set,e.forEach(function(d){i.add(I(d))})):u==="[object Map]"?(i=new Map,e.forEach(function(d,v){i.set(I(v),I(d))})):u==="[object Date]"?i=new Date(+e):u==="[object RegExp]"?i=new RegExp(e.source,e.flags):u==="[object DataView]"?i=new e.constructor(I(e.buffer)):u==="[object ArrayBuffer]"?i=e.slice(0):u.slice(-6)==="Array]"&&(i=new e.constructor(e)),i){for(a=Object.getOwnPropertySymbols(e);n<a.length;n++)fn(i,a[n],Object.getOwnPropertyDescriptor(e,a[n]));for(n=0,a=Object.getOwnPropertyNames(e);n<a.length;n++)Object.hasOwnProperty.call(i,t=a[n])&&i[t]===e[t]||fn(i,t,Object.getOwnPropertyDescriptor(e,t))}return i||e}const en=Symbol("vee-validate-form"),pt=Symbol("vee-validate-field-instance"),Ie=Symbol("Default empty value"),bt=typeof window<"u";function xe(e){return z(e)&&!!e.__locatorRef}function ne(e){return!!e&&z(e.parse)&&e.__type==="VVTypedSchema"}function we(e){return!!e&&z(e.validate)}function je(e){return e==="checkbox"||e==="radio"}function Ot(e){return ge(e)||Array.isArray(e)}function Vt(e){return Array.isArray(e)?e.length===0:ge(e)&&Object.keys(e).length===0}function Ne(e){return/^\[.+\]$/i.test(e)}function _t(e){return Fn(e)&&e.multiple}function Fn(e){return e.tagName==="SELECT"}function St(e,n){const t=![!1,null,void 0,0].includes(n.multiple)&&!Number.isNaN(n.multiple);return e==="select"&&"multiple"in n&&t}function At(e,n){return!St(e,n)&&n.type!=="file"&&!je(n.type)}function jt(e){return Pn(e)&&e.target&&"submit"in e.target}function Pn(e){return e?!!(typeof Event<"u"&&z(Event)&&e instanceof Event||e&&e.srcElement):!1}function vn(e,n){return n in e&&e[n]!==Ie}function q(e,n){if(e===n)return!0;if(e&&n&&typeof e=="object"&&typeof n=="object"){if(e.constructor!==n.constructor)return!1;var t,a,i;if(Array.isArray(e)){if(t=e.length,t!=n.length)return!1;for(a=t;a--!==0;)if(!q(e[a],n[a]))return!1;return!0}if(e instanceof Map&&n instanceof Map){if(e.size!==n.size)return!1;for(a of e.entries())if(!n.has(a[0]))return!1;for(a of e.entries())if(!q(a[1],n.get(a[0])))return!1;return!0}if(hn(e)&&hn(n))return!(e.size!==n.size||e.name!==n.name||e.lastModified!==n.lastModified||e.type!==n.type);if(e instanceof Set&&n instanceof Set){if(e.size!==n.size)return!1;for(a of e.entries())if(!n.has(a[0]))return!1;return!0}if(ArrayBuffer.isView(e)&&ArrayBuffer.isView(n)){if(t=e.length,t!=n.length)return!1;for(a=t;a--!==0;)if(e[a]!==n[a])return!1;return!0}if(e.constructor===RegExp)return e.source===n.source&&e.flags===n.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===n.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===n.toString();for(i=Object.keys(e),t=i.length,a=t;a--!==0;){var u=i[a];if(!q(e[u],n[u]))return!1}return!0}return e!==e&&n!==n}function hn(e){return bt?e instanceof File:!1}function nn(e){return Ne(e)?e.replace(/\[|\]/gi,""):e}function K(e,n,t){return e?Ne(n)?e[nn(n)]:(n||"").split(/\.|\[(\d+)\]/).filter(Boolean).reduce((i,u)=>Ot(i)&&u in i?i[u]:t,e):t}function fe(e,n,t){if(Ne(n)){e[nn(n)]=t;return}const a=n.split(/\.|\[(\d+)\]/).filter(Boolean);let i=e;for(let u=0;u<a.length;u++){if(u===a.length-1){i[a[u]]=t;return}(!(a[u]in i)||Cn(i[a[u]]))&&(i[a[u]]=Ze(a[u+1])?[]:{}),i=i[a[u]]}}function Ke(e,n){if(Array.isArray(e)&&Ze(n)){e.splice(Number(n),1);return}ge(e)&&delete e[n]}function mn(e,n){if(Ne(n)){delete e[nn(n)];return}const t=n.split(/\.|\[(\d+)\]/).filter(Boolean);let a=e;for(let u=0;u<t.length;u++){if(u===t.length-1){Ke(a,t[u]);break}if(!(t[u]in a)||Cn(a[t[u]]))break;a=a[t[u]]}const i=t.map((u,d)=>K(e,t.slice(0,d).join(".")));for(let u=i.length-1;u>=0;u--)if(Vt(i[u])){if(u===0){Ke(e,t[0]);continue}Ke(i[u-1],t[u-1])}}function x(e){return Object.keys(e)}function kn(e,n=void 0){const t=Be();return(t==null?void 0:t.provides[e])||En(e,n)}function yn(e,n,t){if(Array.isArray(e)){const a=[...e],i=a.findIndex(u=>q(u,n));return i>=0?a.splice(i,1):a.push(n),a}return q(e,n)?t:n}function gn(e,n=0){let t=null,a=[];return function(...i){return t&&clearTimeout(t),t=setTimeout(()=>{const u=e(...i);a.forEach(d=>d(u)),a=[]},n),new Promise(u=>a.push(u))}}function Et(e,n){return ge(n)&&n.number?vt(e):e}function Ye(e,n){let t;return async function(...i){const u=e(...i);t=u;const d=await u;return u!==t?d:(t=void 0,n(d,i))}}function Xe(e){return Array.isArray(e)?e:e?[e]:[]}function Ce(e,n){const t={};for(const a in e)n.includes(a)||(t[a]=e[a]);return t}function Ct(e){let n=null,t=[];return function(...a){const i=ue(()=>{if(n!==i)return;const u=e(...a);t.forEach(d=>d(u)),t=[],n=null});return n=i,new Promise(u=>t.push(u))}}function Ft(e,n,t){return n.slots.default?typeof e=="string"||!e?n.slots.default(t()):{default:()=>{var a,i;return(i=(a=n.slots).default)===null||i===void 0?void 0:i.call(a,t())}}:n.slots.default}function Ge(e){if(In(e))return e._value}function In(e){return"_value"in e}function Pt(e){return e.type==="number"||e.type==="range"?Number.isNaN(e.valueAsNumber)?e.value:e.valueAsNumber:e.value}function Me(e){if(!Pn(e))return e;const n=e.target;if(je(n.type)&&In(n))return Ge(n);if(n.type==="file"&&n.files){const t=Array.from(n.files);return n.multiple?t:t[0]}if(_t(n))return Array.from(n.options).filter(t=>t.selected&&!t.disabled).map(Ge);if(Fn(n)){const t=Array.from(n.options).find(a=>a.selected);return t?Ge(t):n.value}return Pt(n)}function wn(e){const n={};return Object.defineProperty(n,"_$$isNormalized",{value:!0,writable:!1,enumerable:!1,configurable:!1}),e?ge(e)&&e._$$isNormalized?e:ge(e)?Object.keys(e).reduce((t,a)=>{const i=kt(e[a]);return e[a]!==!1&&(t[a]=pn(i)),t},n):typeof e!="string"?n:e.split("|").reduce((t,a)=>{const i=It(a);return i.name&&(t[i.name]=pn(i.params)),t},n):n}function kt(e){return e===!0?[]:Array.isArray(e)||ge(e)?e:[e]}function pn(e){const n=t=>typeof t=="string"&&t[0]==="@"?wt(t.slice(1)):t;return Array.isArray(e)?e.map(n):e instanceof RegExp?[e]:Object.keys(e).reduce((t,a)=>(t[a]=n(e[a]),t),{})}const It=e=>{let n=[];const t=e.split(":")[0];return e.includes(":")&&(n=e.split(":").slice(1).join(":").split(",")),{name:t,params:n}};function wt(e){const n=t=>K(t,e)||t[e];return n.__locatorRef=e,n}function Mt(e){return Array.isArray(e)?e.filter(xe):x(e).filter(n=>xe(e[n])).map(n=>e[n])}const Bt={generateMessage:({field:e})=>`${e} is not valid.`,bails:!0,validateOnBlur:!0,validateOnChange:!0,validateOnInput:!1,validateOnModelUpdate:!0};let Je=Object.assign({},Bt);const me=()=>Je,Nt=e=>{Je=Object.assign(Object.assign({},Je),e)},Rt=Nt;async function Mn(e,n,t={}){const a=t==null?void 0:t.bails,i={name:(t==null?void 0:t.name)||"{field}",rules:n,label:t==null?void 0:t.label,bails:a??!0,formData:(t==null?void 0:t.values)||{}},d=(await Tt(i,e)).errors;return{errors:d,valid:!d.length}}async function Tt(e,n){if(ne(e.rules)||we(e.rules))return Dt(n,e.rules);if(z(e.rules)||Array.isArray(e.rules)){const d={field:e.label||e.name,name:e.name,label:e.label,form:e.formData,value:n},v=Array.isArray(e.rules)?e.rules:[e.rules],s=v.length,c=[];for(let y=0;y<s;y++){const p=v[y],V=await p(n,d);if(!(typeof V!="string"&&!Array.isArray(V)&&V)){if(Array.isArray(V))c.push(...V);else{const w=typeof V=="string"?V:Nn(d);c.push(w)}if(e.bails)return{errors:c}}}return{errors:c}}const t=Object.assign(Object.assign({},e),{rules:wn(e.rules)}),a=[],i=Object.keys(t.rules),u=i.length;for(let d=0;d<u;d++){const v=i[d],s=await zt(t,n,{name:v,params:t.rules[v]});if(s.error&&(a.push(s.error),e.bails))return{errors:a}}return{errors:a}}function Ut(e){return!!e&&e.name==="ValidationError"}function Bn(e){return{__type:"VVTypedSchema",async parse(t){var a;try{return{output:await e.validate(t,{abortEarly:!1}),errors:[]}}catch(i){if(!Ut(i))throw i;if(!(!((a=i.inner)===null||a===void 0)&&a.length)&&i.errors.length)return{errors:[{path:i.path,errors:i.errors}]};const u=i.inner.reduce((d,v)=>{const s=v.path||"";return d[s]||(d[s]={errors:[],path:s}),d[s].errors.push(...v.errors),d},{});return{errors:Object.values(u)}}}}}async function Dt(e,n){const a=await(ne(n)?n:Bn(n)).parse(e),i=[];for(const u of a.errors)u.errors.length&&i.push(...u.errors);return{errors:i}}async function zt(e,n,t){const a=gt(t.name);if(!a)throw new Error(`No such validator '${t.name}' exists.`);const i=$t(t.params,e.formData),u={field:e.label||e.name,name:e.name,label:e.label,value:n,form:e.formData,rule:Object.assign(Object.assign({},t),{params:i})},d=await a(n,i,u);return typeof d=="string"?{error:d}:{error:d?void 0:Nn(u)}}function Nn(e){const n=me().generateMessage;return n?n(e):"Field is invalid"}function $t(e,n){const t=a=>xe(a)?a(n):a;return Array.isArray(e)?e.map(t):Object.keys(e).reduce((a,i)=>(a[i]=t(e[i]),a),{})}async function Lt(e,n){const a=await(ne(e)?e:Bn(e)).parse(I(n)),i={},u={};for(const d of a.errors){const v=d.errors,s=(d.path||"").replace(/\["(\d+)"\]/g,(c,y)=>`[${y}]`);i[s]={valid:!v.length,errors:v},v.length&&(u[s]=v[0])}return{valid:!a.errors.length,results:i,errors:u,values:a.value}}async function Wt(e,n,t){const i=x(e).map(async c=>{var y,p,V;const b=(y=t==null?void 0:t.names)===null||y===void 0?void 0:y[c],w=await Mn(K(n,c),e[c],{name:(b==null?void 0:b.name)||c,label:b==null?void 0:b.label,values:n,bails:(V=(p=t==null?void 0:t.bailsMap)===null||p===void 0?void 0:p[c])!==null&&V!==void 0?V:!0});return Object.assign(Object.assign({},w),{path:c})});let u=!0;const d=await Promise.all(i),v={},s={};for(const c of d)v[c.path]={valid:c.valid,errors:c.errors},c.valid||(u=!1,s[c.path]=c.errors[0]);return{valid:u,results:v,errors:s}}let bn=0;function qt(e,n){const{value:t,initialValue:a,setInitialValue:i}=Ht(e,n.modelValue,n.form);if(!n.form){let s=function(b){var w;"value"in b&&(t.value=b.value),"errors"in b&&y(b.errors),"touched"in b&&(V.touched=(w=b.touched)!==null&&w!==void 0?w:V.touched),"initialValue"in b&&i(b.initialValue)};const{errors:c,setErrors:y}=xt(),p=bn>=Number.MAX_SAFE_INTEGER?0:++bn,V=Gt(t,a,c,n.schema);return{id:p,path:e,value:t,initialValue:a,meta:V,flags:{pendingUnmount:{[p]:!1},pendingReset:!1},errors:c,setState:s}}const u=n.form.createPathState(e,{bails:n.bails,label:n.label,type:n.type,validate:n.validate,schema:n.schema}),d=j(()=>u.errors);function v(s){var c,y,p;"value"in s&&(t.value=s.value),"errors"in s&&((c=n.form)===null||c===void 0||c.setFieldError(F(e),s.errors)),"touched"in s&&((y=n.form)===null||y===void 0||y.setFieldTouched(F(e),(p=s.touched)!==null&&p!==void 0?p:!1)),"initialValue"in s&&i(s.initialValue)}return{id:Array.isArray(u.id)?u.id[u.id.length-1]:u.id,path:e,value:t,errors:d,meta:u,initialValue:a,flags:u.__flags,setState:v}}function Ht(e,n,t){const a=Y(F(n));function i(){return t?K(t.initialValues.value,F(e),F(a)):F(a)}function u(c){if(!t){a.value=c;return}t.setFieldInitialValue(F(e),c,!0)}const d=j(i);if(!t)return{value:Y(i()),initialValue:d,setInitialValue:u};const v=Kt(n,t,d,e);return t.stageInitialValue(F(e),v,!0),{value:j({get(){return K(t.values,F(e))},set(c){t.setFieldValue(F(e),c,!1)}}),initialValue:d,setInitialValue:u}}function Kt(e,n,t,a){return ke(e)?F(e):e!==void 0?e:K(n.values,F(a),F(t))}function Gt(e,n,t,a){var i,u;const d=(u=(i=a==null?void 0:a.describe)===null||i===void 0?void 0:i.call(a).required)!==null&&u!==void 0?u:!1,v=Pe({touched:!1,pending:!1,valid:!0,required:d,validated:!!F(t).length,initialValue:j(()=>F(n)),dirty:j(()=>!q(F(e),F(n)))});return ye(t,s=>{v.valid=!s.length},{immediate:!0,flush:"sync"}),v}function xt(){const e=Y([]);return{errors:e,setErrors:n=>{e.value=Xe(n)}}}function Yt(e,n,t){return je(t==null?void 0:t.type)?Jt(e,n,t):Rn(e,n,t)}function Rn(e,n,t){const{initialValue:a,validateOnMount:i,bails:u,type:d,checkedValue:v,label:s,validateOnValueUpdate:c,uncheckedValue:y,controlled:p,keepValueOnUnmount:V,syncVModel:b,form:w}=Xt(t),te=p?kn(en):void 0,_=w||te,G=j(()=>Se(A(e))),$=j(()=>{if(A(_==null?void 0:_.schema))return;const O=F(n);return we(O)||ne(O)||z(O)||Array.isArray(O)?O:wn(O)}),{id:X,value:re,initialValue:le,meta:M,setState:se,errors:R,flags:U}=qt(G,{modelValue:a,form:_,bails:u,label:s,type:d,validate:$.value?Z:void 0,schema:ne(n)?n:void 0}),T=j(()=>R.value[0]);b&&Qt({value:re,prop:b,handleChange:E,shouldValidate:()=>c&&!U.pendingReset});const de=(h,O=!1)=>{M.touched=!0,O&&ae()};async function pe(h){var O,P;if(_!=null&&_.validateSchema){const{results:C}=await _.validateSchema(h);return(O=C[A(G)])!==null&&O!==void 0?O:{valid:!0,errors:[]}}return $.value?Mn(re.value,$.value,{name:A(G),label:A(s),values:(P=_==null?void 0:_.values)!==null&&P!==void 0?P:{},bails:u}):{valid:!0,errors:[]}}const ae=Ye(async()=>(M.pending=!0,M.validated=!0,pe("validated-only")),h=>(U.pendingUnmount[L.id]||(se({errors:h.errors}),M.pending=!1,M.valid=h.valid),h)),Q=Ye(async()=>pe("silent"),h=>(M.valid=h.valid,h));function Z(h){return(h==null?void 0:h.mode)==="silent"?Q():ae()}function E(h,O=!0){const P=Me(h);Oe(P,O)}_n(()=>{if(i)return ae();(!_||!_.validateSchema)&&Q()});function Re(h){M.touched=h}function ce(h){var O;const P=h&&"value"in h?h.value:le.value;se({value:I(P),initialValue:I(P),touched:(O=h==null?void 0:h.touched)!==null&&O!==void 0?O:!1,errors:(h==null?void 0:h.errors)||[]}),M.pending=!1,M.validated=!1,Q()}const ve=Be();function Oe(h,O=!0){re.value=ve&&b?Et(h,ve.props.modelModifiers):h,(O?ae:Q)()}function Ee(h){se({errors:Array.isArray(h)?h:[h]})}const tn=j({get(){return re.value},set(h){Oe(h,c)}}),L={id:X,name:G,label:s,value:tn,meta:M,errors:R,errorMessage:T,type:d,checkedValue:v,uncheckedValue:y,bails:u,keepValueOnUnmount:V,resetField:ce,handleReset:()=>ce(),validate:Z,handleChange:E,handleBlur:de,setState:se,setTouched:Re,setErrors:Ee,setValue:Oe};if(Sn(pt,L),ke(n)&&typeof F(n)!="function"&&ye(n,(h,O)=>{q(h,O)||(M.validated?ae():Q())},{deep:!0}),!_)return L;const Te=j(()=>{const h=$.value;return!h||z(h)||we(h)||ne(h)||Array.isArray(h)?{}:Object.keys(h).reduce((O,P)=>{const C=Mt(h[P]).map(oe=>oe.__locatorRef).reduce((oe,ie)=>{const J=K(_.values,ie)||_.values[ie];return J!==void 0&&(oe[ie]=J),oe},{});return Object.assign(O,C),O},{})});return ye(Te,(h,O)=>{if(!Object.keys(h).length)return;!q(h,O)&&(M.validated?ae():Q())}),Xn(()=>{var h;const O=(h=A(L.keepValueOnUnmount))!==null&&h!==void 0?h:A(_.keepValuesOnUnmount),P=A(G);if(O||!_||U.pendingUnmount[L.id]){_==null||_.removePathState(P,X);return}U.pendingUnmount[L.id]=!0;const C=_.getPathState(P);if(Array.isArray(C==null?void 0:C.id)&&(C!=null&&C.multiple)?C!=null&&C.id.includes(L.id):(C==null?void 0:C.id)===L.id){if(C!=null&&C.multiple&&Array.isArray(C.value)){const ie=C.value.findIndex(J=>q(J,A(L.checkedValue)));if(ie>-1){const J=[...C.value];J.splice(ie,1),_.setFieldValue(P,J)}Array.isArray(C.id)&&C.id.splice(C.id.indexOf(L.id),1)}else _.unsetPathValue(A(G));_.removePathState(P,X)}}),L}function Xt(e){const n=()=>({initialValue:void 0,validateOnMount:!1,bails:!0,label:void 0,validateOnValueUpdate:!0,keepValueOnUnmount:void 0,syncVModel:!1,controlled:!0}),t=!!(e!=null&&e.syncVModel),a=typeof(e==null?void 0:e.syncVModel)=="string"?e.syncVModel:(e==null?void 0:e.modelPropName)||"modelValue",i=t&&!("initialValue"in(e||{}))?Qe(Be(),a):e==null?void 0:e.initialValue;if(!e)return Object.assign(Object.assign({},n()),{initialValue:i});const u="valueProp"in e?e.valueProp:e.checkedValue,d="standalone"in e?!e.standalone:e.controlled,v=(e==null?void 0:e.modelPropName)||(e==null?void 0:e.syncVModel)||!1;return Object.assign(Object.assign(Object.assign({},n()),e||{}),{initialValue:i,controlled:d??!0,checkedValue:u,syncVModel:v})}function Jt(e,n,t){const a=t!=null&&t.standalone?void 0:kn(en),i=t==null?void 0:t.checkedValue,u=t==null?void 0:t.uncheckedValue;function d(v){const s=v.handleChange,c=j(()=>{const p=A(v.value),V=A(i);return Array.isArray(p)?p.findIndex(b=>q(b,V))>=0:q(V,p)});function y(p,V=!0){var b,w;if(c.value===((b=p==null?void 0:p.target)===null||b===void 0?void 0:b.checked)){V&&v.validate();return}const te=A(e),_=a==null?void 0:a.getPathState(te),G=Me(p);let $=(w=A(i))!==null&&w!==void 0?w:G;a&&(_!=null&&_.multiple)&&_.type==="checkbox"?$=yn(K(a.values,te)||[],$,void 0):(t==null?void 0:t.type)==="checkbox"&&($=yn(A(v.value),$,A(u))),s($,V)}return Object.assign(Object.assign({},v),{checked:c,checkedValue:i,uncheckedValue:u,handleChange:y})}return d(Rn(e,n,t))}function Qt({prop:e,value:n,handleChange:t,shouldValidate:a}){const i=Be();if(!i||!e)return;const u=typeof e=="string"?e:"modelValue",d=`update:${u}`;u in i.props&&(ye(n,v=>{q(v,Qe(i,u))||i.emit(d,v)}),ye(()=>Qe(i,u),v=>{if(v===Ie&&n.value===void 0)return;const s=v===Ie?void 0:v;q(s,n.value)||t(s,a())}))}function Qe(e,n){if(e)return e.props[n]}const Zt=An({name:"Field",inheritAttrs:!1,props:{as:{type:[String,Object],default:void 0},name:{type:String,required:!0},rules:{type:[Object,String,Function],default:void 0},validateOnMount:{type:Boolean,default:!1},validateOnBlur:{type:Boolean,default:void 0},validateOnChange:{type:Boolean,default:void 0},validateOnInput:{type:Boolean,default:void 0},validateOnModelUpdate:{type:Boolean,default:void 0},bails:{type:Boolean,default:()=>me().bails},label:{type:String,default:void 0},uncheckedValue:{type:null,default:void 0},modelValue:{type:null,default:Ie},modelModifiers:{type:null,default:()=>({})},"onUpdate:modelValue":{type:null,default:void 0},standalone:{type:Boolean,default:!1},keepValue:{type:Boolean,default:void 0}},setup(e,n){const t=_e(e,"rules"),a=_e(e,"name"),i=_e(e,"label"),u=_e(e,"uncheckedValue"),d=_e(e,"keepValue"),{errors:v,value:s,errorMessage:c,validate:y,handleChange:p,handleBlur:V,setTouched:b,resetField:w,handleReset:te,meta:_,checked:G,setErrors:$}=Yt(a,t,{validateOnMount:e.validateOnMount,bails:e.bails,standalone:e.standalone,type:n.attrs.type,initialValue:nr(e,n),checkedValue:n.attrs.value,uncheckedValue:u,label:i,validateOnValueUpdate:e.validateOnModelUpdate,keepValueOnUnmount:d,syncVModel:!0}),X=function(U,T=!0){p(U,T)},re=j(()=>{const{validateOnInput:R,validateOnChange:U,validateOnBlur:T,validateOnModelUpdate:de}=er(e);function pe(E){V(E,T),z(n.attrs.onBlur)&&n.attrs.onBlur(E)}function ae(E){X(E,R),z(n.attrs.onInput)&&n.attrs.onInput(E)}function Q(E){X(E,U),z(n.attrs.onChange)&&n.attrs.onChange(E)}const Z={name:e.name,onBlur:pe,onInput:ae,onChange:Q};return Z["onUpdate:modelValue"]=E=>X(E,de),Z}),le=j(()=>{const R=Object.assign({},re.value);je(n.attrs.type)&&G&&(R.checked=G.value);const U=On(e,n);return At(U,n.attrs)&&(R.value=s.value),R}),M=j(()=>Object.assign(Object.assign({},re.value),{modelValue:s.value}));function se(){return{field:le.value,componentField:M.value,value:s.value,meta:_,errors:v.value,errorMessage:c.value,validate:y,resetField:w,handleChange:X,handleInput:R=>X(R,!1),handleReset:te,handleBlur:re.value.onBlur,setTouched:b,setErrors:$}}return n.expose({value:s,meta:_,errors:v,errorMessage:c,setErrors:$,setTouched:b,reset:w,validate:y,handleChange:p}),()=>{const R=jn(On(e,n)),U=Ft(R,n,se);return R?Yn(R,Object.assign(Object.assign({},n.attrs),le.value),U):U}}});function On(e,n){let t=e.as||"";return!e.as&&!n.slots.default&&(t="input"),t}function er(e){var n,t,a,i;const{validateOnInput:u,validateOnChange:d,validateOnBlur:v,validateOnModelUpdate:s}=me();return{validateOnInput:(n=e.validateOnInput)!==null&&n!==void 0?n:u,validateOnChange:(t=e.validateOnChange)!==null&&t!==void 0?t:d,validateOnBlur:(a=e.validateOnBlur)!==null&&a!==void 0?a:v,validateOnModelUpdate:(i=e.validateOnModelUpdate)!==null&&i!==void 0?i:s}}function nr(e,n){return je(n.attrs.type)?vn(e,"modelValue")?e.modelValue:void 0:vn(e,"modelValue")?e.modelValue:n.attrs.value}const tr=Zt;let rr=0;const Fe=["bails","fieldsCount","id","multiple","type","validate"];function Tn(e){const n=Object.assign({},A((e==null?void 0:e.initialValues)||{})),t=F(e==null?void 0:e.validationSchema);return t&&ne(t)&&z(t.cast)?I(t.cast(n)||{}):I(n)}function lr(e){var n;const t=rr++;let a=0;const i=Y(!1),u=Y(!1),d=Y(0),v=[],s=Pe(Tn(e)),c=Y([]),y=Y({}),p=Y({}),V=Ct(()=>{p.value=c.value.reduce((l,r)=>(l[Se(A(r.path))]=r,l),{})});function b(l,r){const o=E(l);if(!o){typeof l=="string"&&(y.value[Se(l)]=Xe(r));return}if(typeof l=="string"){const f=Se(l);y.value[f]&&delete y.value[f]}o.errors=Xe(r),o.valid=!o.errors.length}function w(l){x(l).forEach(r=>{b(r,l[r])})}e!=null&&e.initialErrors&&w(e.initialErrors);const te=j(()=>{const l=c.value.reduce((r,o)=>(o.errors.length&&(r[o.path]=o.errors),r),{});return Object.assign(Object.assign({},y.value),l)}),_=j(()=>x(te.value).reduce((l,r)=>{const o=te.value[r];return o!=null&&o.length&&(l[r]=o[0]),l},{})),G=j(()=>c.value.reduce((l,r)=>(l[r.path]={name:r.path||"",label:r.label||""},l),{})),$=j(()=>c.value.reduce((l,r)=>{var o;return l[r.path]=(o=r.bails)!==null&&o!==void 0?o:!0,l},{})),X=Object.assign({},(e==null?void 0:e.initialErrors)||{}),re=(n=e==null?void 0:e.keepValuesOnUnmount)!==null&&n!==void 0?n:!1,{initialValues:le,originalInitialValues:M,setInitialValues:se}=ir(c,s,e),R=ar(c,s,M,_),U=j(()=>c.value.reduce((l,r)=>{const o=K(s,r.path);return fe(l,r.path,o),l},{})),T=e==null?void 0:e.validationSchema;function de(l,r){var o,f;const g=j(()=>K(le.value,A(l))),m=p.value[A(l)],S=(r==null?void 0:r.type)==="checkbox"||(r==null?void 0:r.type)==="radio";if(m&&S){m.multiple=!0;const ee=a++;return Array.isArray(m.id)?m.id.push(ee):m.id=[m.id,ee],m.fieldsCount++,m.__flags.pendingUnmount[ee]=!1,m}const B=j(()=>K(s,A(l))),N=A(l),W=ce.findIndex(ee=>ee===N);W!==-1&&ce.splice(W,1);const k=j(()=>{var ee,Ve,Le,un,We,qe;return ne(T)?(Le=(Ve=(ee=T).describe)===null||Ve===void 0?void 0:Ve.call(ee,A(l)).required)!==null&&Le!==void 0?Le:!1:ne(r==null?void 0:r.schema)&&(qe=(We=(un=r==null?void 0:r.schema).describe)===null||We===void 0?void 0:We.call(un).required)!==null&&qe!==void 0?qe:!1}),D=a++,H=Pe({id:D,path:l,touched:!1,pending:!1,valid:!0,validated:!!(!((o=X[N])===null||o===void 0)&&o.length),required:k,initialValue:g,errors:xn([]),bails:(f=r==null?void 0:r.bails)!==null&&f!==void 0?f:!1,label:r==null?void 0:r.label,type:(r==null?void 0:r.type)||"default",value:B,multiple:!1,__flags:{pendingUnmount:{[D]:!1},pendingReset:!1},fieldsCount:1,validate:r==null?void 0:r.validate,dirty:j(()=>!q(F(B),F(g)))});return c.value.push(H),p.value[N]=H,V(),_.value[N]&&!X[N]&&ue(()=>{he(N,{mode:"silent"})}),ke(l)&&ye(l,ee=>{V();const Ve=I(B.value);p.value[ee]=H,ue(()=>{fe(s,ee,Ve)})}),H}const pe=gn(an,5),ae=gn(an,5),Q=Ye(async l=>await(l==="silent"?pe():ae()),(l,[r])=>{const o=x(O.errorBag.value),g=[...new Set([...x(l.results),...c.value.map(m=>m.path),...o])].sort().reduce((m,S)=>{var B;const N=S,W=E(N)||Re(N),k=((B=l.results[N])===null||B===void 0?void 0:B.errors)||[],D=A(W==null?void 0:W.path)||N,H=ur({errors:k,valid:!k.length},m.results[D]);return m.results[D]=H,H.valid||(m.errors[D]=H.errors[0]),W&&y.value[D]&&delete y.value[D],W?(W.valid=H.valid,r==="silent"||r==="validated-only"&&!W.validated||b(W,H.errors),m):(b(D,k),m)},{valid:l.valid,results:{},errors:{}});return l.values&&(g.values=l.values),x(g.results).forEach(m=>{var S;const B=E(m);B&&r!=="silent"&&(r==="validated-only"&&!B.validated||b(B,(S=g.results[m])===null||S===void 0?void 0:S.errors))}),g});function Z(l){c.value.forEach(l)}function E(l){const r=typeof l=="string"?Se(l):l;return typeof r=="string"?p.value[r]:r}function Re(l){return c.value.filter(o=>l.startsWith(o.path)).reduce((o,f)=>o?f.path.length>o.path.length?f:o:f,void 0)}let ce=[],ve;function Oe(l){return ce.push(l),ve||(ve=ue(()=>{[...ce].sort().reverse().forEach(o=>{mn(s,o)}),ce=[],ve=null})),ve}function Ee(l){return function(o,f){return function(m){return m instanceof Event&&(m.preventDefault(),m.stopPropagation()),Z(S=>S.touched=!0),i.value=!0,d.value++,be().then(S=>{const B=I(s);if(S.valid&&typeof o=="function"){const N=I(U.value);let W=l?N:B;return S.values&&(W=S.values),o(W,{evt:m,controlledValues:N,setErrors:w,setFieldError:b,setTouched:Ue,setFieldTouched:J,setValues:oe,setFieldValue:P,resetForm:De,resetField:rn})}!S.valid&&typeof f=="function"&&f({values:B,evt:m,errors:S.errors,results:S.results})}).then(S=>(i.value=!1,S),S=>{throw i.value=!1,S})}}}const L=Ee(!1);L.withControlled=Ee(!0);function Te(l,r){const o=c.value.findIndex(g=>g.path===l&&(Array.isArray(g.id)?g.id.includes(r):g.id===r)),f=c.value[o];if(!(o===-1||!f)){if(ue(()=>{he(l,{mode:"silent",warn:!1})}),f.multiple&&f.fieldsCount&&f.fieldsCount--,Array.isArray(f.id)){const g=f.id.indexOf(r);g>=0&&f.id.splice(g,1),delete f.__flags.pendingUnmount[r]}(!f.multiple||f.fieldsCount<=0)&&(c.value.splice(o,1),ln(l),V(),delete p.value[l])}}function h(l){x(p.value).forEach(r=>{r.startsWith(l)&&delete p.value[r]}),c.value=c.value.filter(r=>!r.path.startsWith(l)),ue(()=>{V()})}const O={formId:t,values:s,controlledValues:U,errorBag:te,errors:_,schema:T,submitCount:d,meta:R,isSubmitting:i,isValidating:u,fieldArrays:v,keepValuesOnUnmount:re,validateSchema:F(T)?Q:void 0,validate:be,setFieldError:b,validateField:he,setFieldValue:P,setValues:oe,setErrors:w,setFieldTouched:J,setTouched:Ue,resetForm:De,resetField:rn,handleSubmit:L,useFieldModel:Wn,defineInputBinds:qn,defineComponentBinds:Hn,defineField:$e,stageInitialValue:$n,unsetInitialValue:ln,setFieldInitialValue:ze,createPathState:de,getPathState:E,unsetPathValue:Oe,removePathState:Te,initialValues:le,getAllPathStates:()=>c.value,destroyPath:h,isFieldTouched:Un,isFieldDirty:Dn,isFieldValid:zn};function P(l,r,o=!0){const f=I(r),g=typeof l=="string"?l:l.path;E(g)||de(g),fe(s,g,f),o&&he(g)}function C(l,r=!0){x(s).forEach(o=>{delete s[o]}),x(l).forEach(o=>{P(o,l[o],!1)}),r&&be()}function oe(l,r=!0){Ae(s,l),v.forEach(o=>o&&o.reset()),r&&be()}function ie(l,r){const o=E(A(l))||de(l);return j({get(){return o.value},set(f){var g;const m=A(l);P(m,f,(g=A(r))!==null&&g!==void 0?g:!1)}})}function J(l,r){const o=E(l);o&&(o.touched=r)}function Un(l){const r=E(l);return r?r.touched:c.value.filter(o=>o.path.startsWith(l)).some(o=>o.touched)}function Dn(l){const r=E(l);return r?r.dirty:c.value.filter(o=>o.path.startsWith(l)).some(o=>o.dirty)}function zn(l){const r=E(l);return r?r.valid:c.value.filter(o=>o.path.startsWith(l)).every(o=>o.valid)}function Ue(l){if(typeof l=="boolean"){Z(r=>{r.touched=l});return}x(l).forEach(r=>{J(r,!!l[r])})}function rn(l,r){var o;const f=r&&"value"in r?r.value:K(le.value,l),g=E(l);g&&(g.__flags.pendingReset=!0),ze(l,I(f),!0),P(l,f,!1),J(l,(o=r==null?void 0:r.touched)!==null&&o!==void 0?o:!1),b(l,(r==null?void 0:r.errors)||[]),ue(()=>{g&&(g.__flags.pendingReset=!1)})}function De(l,r){let o=I(l!=null&&l.values?l.values:M.value);o=r!=null&&r.force?o:Ae(M.value,o),o=ne(T)&&z(T.cast)?T.cast(o):o,se(o),Z(f=>{var g;f.__flags.pendingReset=!0,f.validated=!1,f.touched=((g=l==null?void 0:l.touched)===null||g===void 0?void 0:g[f.path])||!1,P(f.path,K(o,f.path),!1),b(f.path,void 0)}),r!=null&&r.force?C(o,!1):oe(o,!1),w((l==null?void 0:l.errors)||{}),d.value=(l==null?void 0:l.submitCount)||0,ue(()=>{be({mode:"silent"}),Z(f=>{f.__flags.pendingReset=!1})})}async function be(l){const r=(l==null?void 0:l.mode)||"force";if(r==="force"&&Z(m=>m.validated=!0),O.validateSchema)return O.validateSchema(r);u.value=!0;const o=await Promise.all(c.value.map(m=>m.validate?m.validate(l).then(S=>({key:m.path,valid:S.valid,errors:S.errors})):Promise.resolve({key:m.path,valid:!0,errors:[]})));u.value=!1;const f={},g={};for(const m of o)f[m.key]={valid:m.valid,errors:m.errors},m.errors.length&&(g[m.key]=m.errors[0]);return{valid:o.every(m=>m.valid),results:f,errors:g}}async function he(l,r){var o;const f=E(l);if(f&&(r==null?void 0:r.mode)!=="silent"&&(f.validated=!0),T){const{results:g}=await Q((r==null?void 0:r.mode)||"validated-only");return g[l]||{errors:[],valid:!0}}return f!=null&&f.validate?f.validate(r):(!f&&(o=r==null?void 0:r.warn),Promise.resolve({errors:[],valid:!0}))}function ln(l){mn(le.value,l)}function $n(l,r,o=!1){ze(l,r),fe(s,l,r),o&&!(e!=null&&e.initialValues)&&fe(M.value,l,I(r))}function ze(l,r,o=!1){fe(le.value,l,I(r)),o&&fe(M.value,l,I(r))}async function an(){const l=F(T);if(!l)return{valid:!0,results:{},errors:{}};u.value=!0;const r=we(l)||ne(l)?await Lt(l,s):await Wt(l,s,{names:G.value,bailsMap:$.value});return u.value=!1,r}const Ln=L((l,{evt:r})=>{jt(r)&&r.target.submit()});_n(()=>{if(e!=null&&e.initialErrors&&w(e.initialErrors),e!=null&&e.initialTouched&&Ue(e.initialTouched),e!=null&&e.validateOnMount){be();return}O.validateSchema&&O.validateSchema("silent")}),ke(T)&&ye(T,()=>{var l;(l=O.validateSchema)===null||l===void 0||l.call(O,"validated-only")}),Sn(en,O);function $e(l,r){const o=z(r)||r==null?void 0:r.label,f=E(A(l))||de(l,{label:o}),g=()=>z(r)?r(Ce(f,Fe)):r||{};function m(){var k;f.touched=!0,((k=g().validateOnBlur)!==null&&k!==void 0?k:me().validateOnBlur)&&he(f.path)}function S(){var k;((k=g().validateOnInput)!==null&&k!==void 0?k:me().validateOnInput)&&ue(()=>{he(f.path)})}function B(){var k;((k=g().validateOnChange)!==null&&k!==void 0?k:me().validateOnChange)&&ue(()=>{he(f.path)})}const N=j(()=>{const k={onChange:B,onInput:S,onBlur:m};return z(r)?Object.assign(Object.assign({},k),r(Ce(f,Fe)).props||{}):r!=null&&r.props?Object.assign(Object.assign({},k),r.props(Ce(f,Fe))):k});return[ie(l,()=>{var k,D,H;return(H=(k=g().validateOnModelUpdate)!==null&&k!==void 0?k:(D=me())===null||D===void 0?void 0:D.validateOnModelUpdate)!==null&&H!==void 0?H:!0}),N]}function Wn(l){return Array.isArray(l)?l.map(r=>ie(r,!0)):ie(l)}function qn(l,r){const[o,f]=$e(l,r);function g(){f.value.onBlur()}function m(B){const N=Me(B);P(A(l),N,!1),f.value.onInput()}function S(B){const N=Me(B);P(A(l),N,!1),f.value.onChange()}return j(()=>Object.assign(Object.assign({},f.value),{onBlur:g,onInput:m,onChange:S,value:o.value}))}function Hn(l,r){const[o,f]=$e(l,r),g=E(A(l));function m(S){o.value=S}return j(()=>{const S=z(r)?r(Ce(g,Fe)):r||{};return Object.assign({[S.model||"modelValue"]:o.value,[`onUpdate:${S.model||"modelValue"}`]:m},f.value)})}return Object.assign(Object.assign({},O),{values:Kn(s),handleReset:()=>De(),submitForm:Ln})}function ar(e,n,t,a){const i={touched:"some",pending:"some",valid:"every"},u=j(()=>!q(n,F(t)));function d(){const s=e.value;return x(i).reduce((c,y)=>{const p=i[y];return c[y]=s[p](V=>V[y]),c},{})}const v=Pe(d());return Gn(()=>{const s=d();v.touched=s.touched,v.valid=s.valid,v.pending=s.pending}),j(()=>Object.assign(Object.assign({initialValues:F(t)},v),{valid:v.valid&&!x(a.value).length,dirty:u.value}))}function ir(e,n,t){const a=Tn(t),i=Y(a),u=Y(I(a));function d(v,s=!1){i.value=Ae(I(i.value)||{},I(v)),u.value=Ae(I(u.value)||{},I(v)),s&&e.value.forEach(c=>{if(c.touched)return;const p=K(i.value,c.path);fe(n,c.path,I(p))})}return{initialValues:i,originalInitialValues:u,setInitialValues:d}}function ur(e,n){return n?{valid:e.valid&&n.valid,errors:[...e.errors,...n.errors]}:e}const fr=An({__name:"SmartForm",props:{fields:{default:()=>[]},initialValues:{default:()=>({})},loading:{type:Boolean,default:!1}},setup(e){const n=En("form",Y());Rt({validateOnBlur:!1});const t=d=>d.props||{},a=d=>d.events||{},i=d=>typeof d.key=="function"?d.key():d.key,u=j(()=>{const d=e.fields.reduce((v,s)=>{const c=typeof s.key=="function"?s.key():s.key;if(s.rule)if(c.includes(".")){const y=c.split("."),p={},V=y[0];y.shift(),rt.set(p,y.join("."),s.rule),v[V]=dn().shape(p)}else v[c]=s.rule;return v},{});return dn(d)});return n.value||(n.value=lr({validationSchema:u,initialValues:e.initialValues,keepValuesOnUnmount:!0})),(d,v)=>(He(),on(ft,null,{default:sn(()=>[(He(!0),Jn(Zn,null,Qn(d.fields,(s,c)=>et(d.$slots,s.key,{key:`${c}-${s.key}`},()=>[Vn(F(tr),{name:i(s)},{default:sn(({value:y,handleChange:p,errors:V})=>[(He(),on(jn(s.component),nt({class:"mb-2","model-value":y,loading:d.loading,"onUpdate:modelValue":p,"error-messages":V},t(s),tt(a(s))),null,16,["model-value","loading","onUpdate:modelValue","error-messages"]))]),_:2},1032,["name"])])),128))]),_:3}))}});export{fr as _};
